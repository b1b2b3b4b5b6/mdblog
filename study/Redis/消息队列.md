# 消息队列
## 概览
|             |    list     |      stream      |
| ----------- | ----------- | ---------------- |
| 阻塞式消费   | 支持         | 支持              |
| 发布/订阅    | 不支持       | 支持              |
| 重复消费     | 不支持       | 支持              |
| 持久化       | 支持         | 支持              |
| 消息堆积     | 内存持续增长 | 可控制队列最大长度 |
| 消息是否丢失 | 会          | 会                |
| 消息积压能力 | 内存压力大   | 内存压力大         |

## list队列
* 使用list, rpush/push入队列, lpop/rpop出队列, 无阻塞
* 使用list,  rpush/push入队列, blpop/brpop出队列, 带阻塞

## stream队列
* `xadd`发布消息
* `xread`读取消息
* `xgroup`创建消费者组
* `xreadgroup`在指定消费组下,开启消费者拉取消息

## 延时队列
使用zset实现, 将消息作为value, 将到期时间作为score, 用多个线程轮询zset获取到期的任务进行处理, 多个线程为了保障可用性.

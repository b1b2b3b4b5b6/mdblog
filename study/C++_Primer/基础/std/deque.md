<!--
author: lumos
date: 2024-12-16
title:  
tags: 
category: 
status: draft
summary: 
-->


# 标准库类型deque
```C++
#include <deque>
using std::deque;
```
- 双端队列，可在两端高效插入和删除
- 支持随机访问
- 是类模板

##### 初始化方式
| 方式                      | 说明                           |
| :------------------------ | :---------------------------- |
| deque<T> d1               | 默认初始化，空deque             |
| deque<T> d2(d1)           | 包含d1所有元素的副本            |
| deque<T> d3 = d1          | 包含d1所有元素的副本            |
| deque<T> d4(n)            | 包含n个重复执行了默认初始化的对象 |
| deque<T> d5(n, val)       | 包含n个元素，每个元素的值都是val |
| deque<T> d6{a,b,c...}     | 包含列表内的元素                |
| deque<T> d7 = {a,b,c...}  | 包含列表内的元素                |

##### 对deque的写入操作
| 方式                | 说明                                      |
| :----------------- | :--------------------------------------- |
| d.push_back(t)     | 向队尾添加t元素，优先使用移动构造，其次拷贝构造 |
| d.push_front(t)    | 向队首添加t元素，优先使用移动构造，其次拷贝构造 |
| d.emplace_back(args...) | 在队尾就地构造元素                    |
| d.emplace_front(args...) | 在队首就地构造元素                   |
| d.pop_back()       | 删除队尾元素                             |
| d.pop_front()      | 删除队首元素                             |
| d.insert(pos, t)   | 在迭代器pos前插入元素t                    |
| d.erase(pos)       | 删除迭代器pos指向的元素                   |
| d.erase(first, last) | 删除迭代器范围内的元素                  |
| d.resize(ns)       | ns < size:析构多余元素；ns > size:默认构造缺失元素 |
| d.clear()          | 删除所有元素                             |
| d.swap(d2)         | 交换两个deque的内容                       |
| d1 = d2            | 用d2中元素的拷贝替换d1中的元素             |
| d1 = {a,b,c...}    | 用列表中的元素替换d1中的元素              |

##### 对deque的读取操作
| 方式            | 说明                                                      |
| :-------------- | :-------------------------------------------------------- |
| d.empty()       | 如果d为空，返回真，否则返回假                                |
| d.size()        | 返回d中的元素个数，size_type类型                            |
| d[n]            | 返回d中第n个位置上元素的引用，从0计，n是size_type类型         |
| d.at(n)         | 返回d中第n个位置上元素的引用，带边界检查                      |
| d.front()       | 返回队首元素的引用                                         |
| d.back()        | 返回队尾元素的引用                                         |
| d1 == d2        | 元素完全相同且位置一致时返回真                               |
| d1 != d2        | 元素完全相同且位置一致时返回假，否则返回真                     |
| <, <=, >, >=    | 由第一对相异的元素值的大小决定（位置对应，长度不同时，较长更大） |

>注：只有在T可比较的情况下，deque<T>才可比较

##### 迭代器本质
- `deque<T>::iterator`为类类型（非指针）
- 支持随机访问，但不保证连续内存

##### range-for迭代
拷贝方式，不可赋值
```C++
for(auto i : d)			
	cout << i << endl;
```
引用方式，可赋值
```C++
for(auto &i : d)			//循环变量定义为引用
	cout << i << endl;
```

##### 使用示例
```C++
deque<int> d;

// 两端插入
d.push_back(3);    // {3}
d.push_front(1);   // {1, 3}
d.push_back(4);    // {1, 3, 4}
d.push_front(0);   // {0, 1, 3, 4}

// 随机访问
cout << d[2] << endl;  // 输出3
d[1] = 2;              // {0, 2, 3, 4}

// 访问两端
cout << d.front() << endl;  // 输出0
cout << d.back() << endl;   // 输出4

// 两端删除
d.pop_front();  // {2, 3, 4}
d.pop_back();   // {2, 3}

// 遍历
for(const auto &val : d) {
    cout << val << " ";
}
```

##### deque vs vector
| 特性          | deque                | vector              |
| :----------- | :------------------- | :------------------ |
| 随机访问      | 支持，稍慢            | 支持，快速           |
| 首部插入删除  | O(1)                 | O(n)                |
| 尾部插入删除  | O(1)                 | O(1)摊销            |
| 内存布局      | 分段连续              | 连续                |
| 迭代器失效    | 插入删除可能导致失效   | 插入删除可能导致失效 |

##### 常见应用场景
- 需要两端操作的场景
- 滑动窗口问题
- 作为queue和stack的底层容器
- 不需要内存连续的序列容器
